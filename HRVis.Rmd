---
title: ""

output: statsr:::statswithr_lab
---

### Plotting H-R Diagrams in R
#### Astronomy: Exploring Space and Time
##### University of Arizona
##### Fall 2018
##### Created by Tony Gojanovic
***

```{r echo=FALSE,message=FALSE,warning=FALSE}
# Libraries for the graphs

library(ggplot2)
library(gridExtra)
library(knitr)
library(plotly)
library(viridis)
library(ggplot2)
library(dplyr)
library(knitr)
library(lattice)
library(readxl)
library(kableExtra)
library(formattable)
library(tidyr)

```


###Simple Interactive H-R Diagram (McDonald Observatory Dataset) for Learning Project
#### Theoretical Hertzsprung–Russell diagram

The following interactive Hertzsprung-Russell Diagram is based on data obtained from the McDonald Observatory (see reference in this section).  This data set and illustration can be used for an observational project since both right ascension and declination has been provided for the majority of stars in the diagram.

This form of the H-R diagram in which apparent magnitude and temperature is called the 'Theoretical Hertzsprung–Russell Diagram.' A characteristic of this form of the H–R diagram is that the temperatures are plotted from high temperature to low temperature, which aids in comparing this form of the H–R diagram with the observational form.

Note that the graph colors are not an exact match to star color, but rather just show delineations of different regions.

```{r echo=FALSE,message=FALSE,warning=FALSE}
library(readxl)
setwd("/Users/tonygojanovic/Data")
mcdonaldstars <- read_excel("R Projects/Hertzsprung-Russell/mcdonaldstars.xlsx")
View(mcdonaldstars)
```

```{r echo=FALSE,warning=FALSE,message=FALSE}
mcdonaldstars<-mcdonaldstars%>% mutate(spectral_type = ifelse(temp <=3500  & temp > 2000, "M", ifelse(temp <=4900 & temp >3500, "K",ifelse(temp <=6000 & temp > 4900,"G",ifelse(temp <=7400 & temp > 60000,"F",ifelse(temp  <=9900 & temp > 7400,"A",ifelse(temp<=28000 & temp > 9900, "B",ifelse(temp <=50000 & temp > 28000,"O","F"))))))))
```

```{r fig.height=8,fig.width=8,echo=FALSE,warning=FALSE,message=FALSE}

mcdonaldstars<-mcdonaldstars%>% mutate(spectral_type = ifelse(temp <=3500  & temp > 2000, "M", ifelse(temp <=4900 & temp >3500, "K",ifelse(temp <=6000 & temp > 4900,"G",ifelse(temp <=7400 & temp > 60000,"F",ifelse(temp  <=9900 & temp > 7400,"A",ifelse(temp<=28000 & temp > 9900, "B",ifelse(temp <=50000 & temp > 28000,"O","F"))))))))


p1<-ggplot(mcdonaldstars,aes(temp,absolute,label0=star,label1=light_years,label2=apparent,label3=spectral_type,label4=temp,label5=constellation,label6=notes,label7=RA,label8=Dec))+geom_point(aes(color=temp))
p1<-p1+scale_x_reverse(breaks = seq(5000, 30000, by = 5000))+scale_y_reverse(breaks = seq(-10,20,by=2))
p1<-p1+guides(color=F, alpha=F)+
    scale_alpha_continuous(range=c(0,1))+
    scale_color_gradientn(
      colours=c("red","skyblue","blue","white","white"),
      limits= c(1000,30000))
p1<-p1+ggtitle("Simple H-R Diagram (McDonald Observatory Dataset)")+ylab("Absolute Magnitude")+xlab("Degrees Kelvin")
p1<-p1+theme(panel.background = element_rect(fill = "black"))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
p1<-ggplotly(p1,tooltip = c("star","light_years","apparent","spectral_type","constellation","notes","RA","Dec"))
p1
```

